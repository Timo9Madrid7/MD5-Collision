# MD5_Collision
IN4253ETHackLab


Goals:

– reproduce paper

– perform a risk analysis of a real system in place

– test the security of a system and understand vulnerabilities

– develop and suggest countermeasures

To be more specific:

Reproduce Wang's work based on python:

Following is Wang's approach on MD5 first differential path:

Reference:PhD-Thesis-Marc-Stevens-Attacks-on-Hash-Functions-and-Applications

![WANG](https://user-images.githubusercontent.com/79078851/109712555-74d48280-7ba0-11eb-9e2e-b753abfcbf09.PNG)

Following is the basic concept of Wang's attack
A collision is generated using two consecutive pairs of message blocks (B0, B′0) and and (B1, B′1), where B′
0 ̸= B0 and B′1 ̸= B1, that are appended to the two prefixes. Together they result in a collision IHVThe collision attack′k+2 = IHVk+2.
outputs two messages M = P||B0||B1 and M′ = P′||B′0||B′1 that result in the same MD5 hash. Due to the incremental nature of MD5, these messages can be further
extended using an identical suffix S, resulting in the colliding messages P||B0||B1||S and P′||B′0||B′1||S.
Note that all blocks M0, . . . , Mk−1 and Mk+2, . . . , MN−1 can be chosen arbitrarily and that only B0, B′0, B1 and B′1 are generated by the collision finding algorithm using the value of IHV ′k = IHVk.
![捕获2](https://user-images.githubusercontent.com/79078851/109721741-0a294400-7bac-11eb-806b-cd497c882cd7.PNG)

To be more specific:
first differential path:
block 1:
input:(m, random_IV_0) output:(IV_1)
block 2:
input:(m', IV_1) output:(IV_2)
second differential path:
block 1:
Input:(n, same_random_IV_0) output:(IV_1_diff)
block 2:
Input:(n', IV_1_diff) output:(IV_2_diff)
Input:()

How to apply to any message after find m,n m',n':
change random_IV_0 to any intermidiate IV of the message using MD5

How to find m|m' n|n':
create m, n based on following graphs, find m,n which can satisfy following requrement, 
![捕获5](https://user-images.githubusercontent.com/79078851/109813165-42bd3200-7c2d-11eb-9e3a-3d4f67abbc95.PNG)
![捕获3](https://user-images.githubusercontent.com/79078851/109811948-be1de400-7c2b-11eb-943d-e3218c7d953c.PNG)
![捕获4](https://user-images.githubusercontent.com/79078851/109811961-c1b16b00-7c2b-11eb-893b-b2b2fcca7e55.PNG)

Reference:PhD-Thesis-Marc-Stevens-Attacks-on-Hash-Functions-and-Applications

